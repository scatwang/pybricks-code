(self.webpackChunk_pybricks_pybricks_code=self.webpackChunk_pybricks_pybricks_code||[]).push([[618],{618:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>ie});var n=o(21553),i=o(44239),r=o(59560),s=o(83057),d=o(43840),l=o(72987),a=o(95811),c=o(17607),u=o(70280),p=o(29158),h=o(79734),m=o(76244),b=o(17721),v=o(98782),f=o(29291),g=o(99447),C=o(14531),x=o(15029),y=o.n(x),j=o(94768),D=o(82545),k=o(64042),E=o(57889),S=o(96680),w=o(36013),N=o(38713),M=o(7715),A=o(62025),R=o(88317),I=o(92406),U=o(18082),P=o(41547),V=o(61913);const F=o.p+"static/media/logo.631fa58c772b5ad095977e19acdf8776.svg";var T=o(51541);const L=-Math.PI/9;var W=function(e){return e[e.Stop=0]="Stop",e[e.ChangeSpeed=1]="ChangeSpeed",e[e.Update=2]="Update",e}(W||{});function H(e,t){switch(t.type){case W.Stop:return{...e,rotation:e.rotation,rotationSpeed:0};case W.ChangeSpeed:return{...e,rotationSpeed:e.rotationSpeed+t.amount};case W.Update:return{...e,rotation:e.rotation+e.rotationSpeed*t.timeDelta};default:return e}}const O=e=>{let{isVisible:t}=e;const o=(0,E.useRef)({rotation:L,rotationSpeed:0}),n=(0,E.useRef)(null),{isDarkMode:i}=(0,N.vy)(),r=(0,E.useRef)("");return r.current=function(e){return e?P.Colors.GRAY1:P.Colors.GRAY5}(i),(0,E.useEffect)((()=>{if(!t)return;const e=n.current;if(!e)return void console.error("elementRef.current was null!");const i=new V.Z({fitted:!0}).appendTo(e),s=i.load(F,(e=>{e.center(),i.add(s),i.play()}));i.addEventListener("update",((e,t)=>{o.current=H(o.current,{type:W.Update,timeDelta:t/1e3}),s.fill=r.current,s.scale=Math.min(i.width,i.height)/80,s.rotation=o.current.rotation,i.scene.position.x=i.width/2,i.scene.position.y=i.height/2}));const d=new ResizeObserver((()=>{i.fit()}));d.observe(e);const l=e=>{e.stopPropagation(),e.preventDefault(),o.current=H(o.current,{type:W.Stop})};i.renderer.domElement.addEventListener("pointerdown",l,{capture:!0});const a=e=>{const t=e;o.current=H(o.current,{type:W.ChangeSpeed,amount:.1*Math.sign(-t.deltaY)})};return i.renderer.domElement.addEventListener("wheel",a,{passive:!0}),i.renderer.domElement.setAttribute("aria-hidden","true"),()=>{i.renderer.domElement.removeEventListener("wheel",a),i.renderer.domElement.removeEventListener("pointerdown",l),d.disconnect(),i.removeEventListener("update"),e.removeChild(i.renderer.domElement),i.clear()}}),[t]),(0,T.jsx)("div",{className:"pb-editor-welcome",ref:n,onContextMenuCapture:e=>{e.stopPropagation(),e.preventDefault()}})};var _=o(40759),z=o(21651),$=o(74118);function K(){const[e]=(0,$.Q)({id:"i18n_1nkaw6a",fallback:z,translations(e){if(!([].indexOf(e)<0))return o(1856)(`./${e}.json`).then((e=>e&&e.default))}});return e}var Z=o(38696);class Y{constructor(e,t){this.toDispose=void 0,this.untitledHintContentWidget=void 0,this.editor=e,this.placeholder=t,this.toDispose=[],this.toDispose.push(e.onDidChangeModel((()=>this.update()))),this.update()}update(){var e;null===(e=this.untitledHintContentWidget)||void 0===e||e.dispose(),this.untitledHintContentWidget=new B(this.editor,this.placeholder)}dispose(){var e;this.toDispose.forEach((e=>e.dispose())),null===(e=this.untitledHintContentWidget)||void 0===e||e.dispose()}}Y.ID="editor.contrib.untitledHint";class B{constructor(e,t){this.domNode=void 0,this.toDispose=void 0,this.editor=e,this.placeholder=t,this.toDispose=[],this.toDispose.push(e.onDidChangeModelContent((()=>this.onDidChangeModelContent()))),this.onDidChangeModelContent()}onDidChangeModelContent(){""===this.editor.getValue()?this.editor.addContentWidget(this):this.editor.removeContentWidget(this)}getId(){return B.ID}getDomNode(){return this.domNode||(this.domNode=document.createElement("div"),this.domNode.textContent=this.placeholder,this.domNode.className="pb-editor-placeholder",this.editor.applyFontInfo(this.domNode)),this.domNode}getPosition(){return{position:{lineNumber:1,column:1},preference:[0]}}dispose(){this.editor.removeContentWidget(this),this.toDispose.forEach((e=>e.dispose()))}}B.ID="editor.widget.untitledHint",j.Mj.register({id:Z.ad});(new Array).push(j.Mj.setLanguageConfiguration(Z.ad,Z.aK),j.Mj.setMonarchTokensProvider(Z.ad,Z.dK),j.Mj.registerCompletionItemProvider(Z.ad,Z.Qe));const Q="tomorrow-night-eighties";j.j6.defineTheme(Q,D);const G="xcode";j.j6.defineTheme(G,k);const J=e=>{let{label:t,icon:o,keyboardShortcut:i,disabled:r,editor:s,editorAction:d}=e;const l=(0,S.Me)();return(0,T.jsx)(n.s,{role:"menuitem","aria-labelledby":l,text:(0,T.jsx)("span",{id:l,children:t}),icon:o,label:i,disabled:r,onClick:()=>{null===s||void 0===s||s.focus(),null===s||void 0===s||s.trigger(null,d,null)}})},q=e=>{let{editor:t}=e;const o=K(),n=null===t||void 0===t?void 0:t.getSelection(),s=n&&!n.isEmpty(),d=null===t||void 0===t?void 0:t.getModel(),l=d&&d.canUndo(),a=d&&d.canRedo();return(0,T.jsxs)(i.v,{"aria-label":o.translate("contextMenu.label"),role:"menu",children:[(0,T.jsx)(J,{label:o.translate("copy"),icon:(0,T.jsx)(h.F,{}),keyboardShortcut:(0,U.eE)()?"Cmd-C":"Ctrl-C",disabled:!s,editor:t,editorAction:"editor.action.clipboardCopyAction"}),(0,T.jsx)(J,{label:o.translate("paste"),icon:(0,T.jsx)(m.T,{}),keyboardShortcut:(0,U.eE)()?"Cmd-V":"Ctrl-V",disabled:!d,editor:t,editorAction:"editor.action.clipboardPasteAction"}),(0,T.jsx)(J,{label:o.translate("selectAll"),icon:(0,T.jsx)(b.e,{}),keyboardShortcut:(0,U.eE)()?"Cmd-A":"Ctrl-A",disabled:!d,editor:t,editorAction:"editor.action.selectAll"}),(0,T.jsx)(r.R,{}),(0,T.jsx)(J,{label:o.translate("undo"),icon:(0,T.jsx)(v.W,{}),keyboardShortcut:(0,U.eE)()?"Cmd-Z":"Ctrl-Z",disabled:!l,editor:t,editorAction:"undo"}),(0,T.jsx)(J,{label:o.translate("redo"),icon:(0,T.jsx)(f.J,{}),keyboardShortcut:(0,U.eE)()?"Cmd-Shift-Z":"Ctrl-Shift-Z",disabled:!a,editor:t,editorAction:"redo"})]})},X=e=>{let{id:t,uuid:o,onNameChanged:n}=e;const i=(0,M.sN)(o);return(0,E.useEffect)((()=>{null===n||void 0===n||n()}),[i,n]),(0,T.jsx)(s.x,{tagName:"span",id:t,ellipsize:!0,children:i})},ee=e=>{var t;let{uuid:o}=e;const n=null!==(t=(0,M.sN)(o))&&void 0!==t?t:"",i=(0,w.I0)(),r=K();return(0,T.jsx)(d.z,{title:r.translate("closeFile.tooltip",{fileName:n}),minimal:!0,small:!0,icon:(0,T.jsx)(g.X,{}),tabIndex:-1,onFocus:e=>e.preventDefault(),onClick:e=>{i((0,_.Vs)(o)),e.stopPropagation()}})},te=e=>{let{onChange:t}=e;const o=(0,R.v)((e=>e.editor.openFileUuids)),n=(0,R.v)((e=>e.editor.activeFileUuid)),i=(0,w.I0)(),r=(0,E.useCallback)((e=>{i((0,_.uR)(e)),null===t||void 0===t||t()}),[i,t]),s=(0,S.Me)(),d=(0,E.useCallback)(((e,t)=>{"Delete"===e.key&&(i((0,_.Vs)(t)),e.preventDefault(),e.stopPropagation())}),[i]),c=(0,E.useCallback)(((e,t)=>{1===e.button&&(i((0,_.Vs)(t)),e.preventDefault(),e.stopPropagation())}),[i]),u=(0,E.useRef)(null),p=(0,E.useCallback)((()=>{var e;null===(e=u.current)||void 0===e||e.moveSelectionIndicator()}),[u]),h=K();return(0,E.useEffect)((()=>{var e;const t=null===(e=u.current)||void 0===e?void 0:e.tablistElement;t&&t.setAttribute("aria-label",h.translate("tablist.label"))}),[h]),(0,T.jsx)(l.mQ,{className:"pb-editor-tablist",selectedTabId:n||void 0,ref:u,onChange:r,children:o.map((e=>(0,T.jsxs)(a.O,{className:"pb-editor-tablist-tab","aria-labelledby":`${s}.${e}`,id:e,onKeyDown:t=>d(t,e),onMouseUp:t=>c(t,e),children:[(0,T.jsx)(X,{id:`${s}.${e}`,uuid:e,onNameChanged:p}),(0,T.jsx)(ee,{uuid:e})]},e)))})};function oe(e,t,o){(0,E.useEffect)((()=>{if(e)return t(e)}),[e,t,...o])}function ne(e,t,o){oe(e,(e=>{const o=e.addAction(t());return()=>o.dispose()}),o)}const ie=()=>{const e=(0,w.I0)(),[t,o]=(0,E.useState)(),{isSettingShowDocsEnabled:n,toggleIsSettingShowDocsEnabled:i}=(0,I.B)(),{isDarkMode:r}=(0,N.vy)(),s=K();(0,E.useEffect)((()=>{j.j6.setTheme(r?Q:G)}),[r]),oe(t,(e=>{const t=new Y(e,s.translate("placeholder"));return()=>t.dispose()}),[s]),ne(t,(()=>({id:"pybricks.action.toggleDocs",label:s.translate("toggleDocs"),run:()=>i(),keybindings:[j.DC.CtrlCmd|j.VD.KeyD]})),[s,i]),ne(t,(()=>({id:"pybricks.action.check",label:s.translate("check"),run:t=>{e((0,A.MY)(t.getValue(),6,[]))},keybindings:[j.VD.F2]})),[s,e]),ne(t,(()=>({id:"pybricks.action.save",label:"Unused",run:()=>{console.debug("Ctrl-S ignored")},keybindings:[j.DC.CtrlCmd|j.VD.KeyS]})),[]);const l=(0,E.useMemo)((()=>({onOpened:e=>{const t=e.getElementsByClassName(c.URx).item(0);t instanceof HTMLElement?t.focus():console.error(`bug: firstItem is not an HTMLElement: ${t}`)},onClosed:()=>null===t||void 0===t?void 0:t.focus()})),[t]),a=(0,E.useRef)(null);(0,N.qR)((()=>{if(!a.current)return void console.error("no editorRef!");const e=j.j6.create(a.current,{model:null,fontSize:18,minimap:{enabled:!1},contextmenu:!1,rulers:[80],lineNumbersMinChars:4,wordBasedSuggestions:"off",selectionClipboard:!1});return e.focus(),o(e),()=>{o(void 0),e.dispose()}}));const h=(0,R.v)((e=>0===e.editor.openFileUuids.length)),{activeFileUuid:m}=(0,R.v)((e=>e.editor)),b=(0,M.sN)(null!==m&&void 0!==m?m:"");return(0,T.jsxs)("div",{className:"pb-editor",children:[(0,T.jsx)(te,{onChange:()=>null===t||void 0===t?void 0:t.focus()}),(0,T.jsx)(u.z,{onResize:()=>null===t||void 0===t?void 0:t.layout(),children:(0,T.jsxs)(p.x,{className:y()("pb-editor-tabpanel",h&&"pb-empty"),role:"tabpanel","aria-label":h?s.translate("welcome"):b,content:()=>(0,T.jsx)(q,{editor:t}),popoverProps:l,children:[(0,T.jsx)(O,{isVisible:h}),(0,T.jsx)("div",{className:"pb-editor-monaco",ref:a})]})}),(0,T.jsx)(d.z,{className:"pb-editor-doc-button",minimal:!0,large:!0,icon:(0,T.jsx)(C.x,{}),title:n?s.translate("docs.hide"):s.translate("docs.show"),onClick:i})]})}},1856:(e,t,o)=>{var n={"./en.json":21651};function i(e){return r(e).then((e=>o.t(e,19)))}function r(e){return Promise.resolve().then((()=>{if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}))}i.keys=()=>Object.keys(n),i.resolve=r,i.id=1856,e.exports=i},21651:e=>{"use strict";e.exports=JSON.parse('{"tablist":{"label":"Editor"},"welcome":"Welcome","placeholder":"Write your program here...","check":"Check syntax","toggleDocs":"Toggle documentation","copy":"Copy","paste":"Paste","selectAll":"Select all","undo":"Undo","redo":"Redo","closeFile":{"tooltip":"Close {fileName}"},"contextMenu":{"label":"Editor context menu"},"docs":{"show":"Show documentation","hide":"Hide documentation"}}')}}]);
//# sourceMappingURL=618.87da9038.chunk.js.map